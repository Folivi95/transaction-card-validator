from kafka import KafkaProducer
import json

producer = KafkaProducer(
    bootstrap_servers="localhost:9093",
    value_serializer=lambda v: json.dumps(v).encode('utf-8')
    # security_protocol='SASL_PLAINTEXT',
    # sasl_mechanism='SCRAM-SHA-512',
    # sasl_plain_username='admin',
    # sasl_plain_password='admin'
)

msg_value_way4 = {
    "table": "OWS.DOC",
    "op_type": "U",
    "op_ts": "2022-05-17 11:39:38.000",
    "current_ts": "2022-05-17 11:39:42.110",
    "pos": "00000000040013933522",
    "before": {
        "ACQ_REF_NUMBER": "",
        "ACTION": "",
        "ADD_INFO": "POSTAL_CODE=108;TRANS_LOCATION=Armuli 30;TOP_CONTRACT=866820;MERCH_COUNTRY=ISL;MPD=1025100006600352000;AP_PRTCL=2;SCA_RSN=10000;MERCH_CITY=Reykjavik    ;VPD=0000000007;MERCH_PC=IS108;MERCH_NAME=cardstream               ;BOR_ORIG_MID=9275444;TGTCC=ISL;PRODUCT_ID=MCO;APRPD_IND=N;CARD_AFS=C;CARD_PTI=2;ISO_CONTRACT=N;BORGUN_REGION=DOM;BASE_FEE=0;FEE_CURR=840;CARDTYPE=MCO;NNS_TR_CURR=352;C_ACQ_BIN;BINCHL=E;ACQ_NL;OPID=36824;ONLINE=Y;OC=E;RMSO=Y;SP_IPS_PRODUCT=MC;SP_USD_AMOUNT=0;SP_ISK_AMOUNT=0;ORIG_ID=12413672330;ORIGID_CNT=0;T_USG=X;S_USG=MXK;ACQ_USG;SLI=210;CVC2R=M;NRC=00;MDE16=20220517;FNW=E;",
        "AMND_DATE": "2022-05-17 11:39:30.000",
        "AMND_OFFICER": 14400,
        "AMND_PREV": 12413672330,
        "AMND_STATE": "A",
        "AUTH_CODE": "006814",
        "BIN_RECORD": 8439210,
        "CARD_EXPIRE": "2301",
        "CARD_SEQV_NUMBER": "",
        "CHANGE_VERSION": 0,
        "COMMENT_TEXT": "",
        "DOC__CHAIN__ID": 0,
        "DOC__ORIG__ID": 0,
        "DOC__PREV__ID": 0,
        "DOC__SUMM__ID": 0,
        "FX_SETTL_DATE": "2022-05-17 00:00:00.000",
        "ID": 12413672330,
        "IS_AUTHORIZATION": "P",
        "ISS_REF_NUMBER": "NET06013213544558740______2037",
        "MERCHANT_ID": "9275444",
        "MESSAGE_CATEGORY": "",
        "NUMBER_IN_CHAIN": 0,
        "NUMBER_OF_SUB_S": 0,
        "NW_REF_DATE": "2022-05-17 11:39:30.000",
        "OUTWARD_STATUS": "T",
        "PARTITION_KEY": "X",
        "POSTING_DATE": "",
        "POSTING_STATUS": "P",
        "PS_REF_NUMBER": "MCC011I3V0517",
        "REASON_CODE": "",
        "REASON_DETAILS": "",
        "REC_DATE": "2022-05-17 11:39:30.000",
        "REC_MEMBER_ID": "",
        "RECONS_AMOUNT": 0,
        "RECONS_CURR": "352",
        "REQUEST_CATEGORY": "Q",
        "REQUIREMENT": "",
        "RET_REF_NUMBER": "213780213544",
        "RETURN_CODE": 0,
        "S_CAT": "M",
        "SEC_TRANS_COND_ATT": 0,
        "SEC_TRANS_DATE": "",
        "SEND_MEMBER_ID": "005302",
        "SENDING_BIN": "545302",
        "SERVICE_CLASS": "X",
        "SETTL_AMOUNT": 0,
        "SETTL_CURR": "352",
        "SIC_CODE": "5734",
        "SOURCE_ACC_TYPE": "",
        "SOURCE_CHANNEL": "P",
        "SOURCE_CODE": "",
        "SOURCE_CONTRACT": 3091900,
        "SOURCE_FEE_AMOUNT": 0,
        "SOURCE_FEE_CODE": "",
        "SOURCE_FEE_CURR": "",
        "SOURCE_IDT_SCHEME": "",
        "SOURCE_MEMBER_ID": "1501",
        "SOURCE_NUMBER": "NET06013",
        "SOURCE_REG_NUM": "M137114LAITN",
        "SOURCE_SERVICE": 0,
        "SOURCE_SPC": "",
        "SYNCH_TAG": "",
        "T_CAT": "C",
        "TARGET_ACC_TYPE": "",
        "TARGET_BIN_ID": 0,
        "TARGET_CHANNEL": "E",
        "TARGET_CODE": "",
        "TARGET_CONTRACT": 659560,
        "TARGET_COUNTRY": "ISL",
        "TARGET_FEE_AMOUNT": 0,
        "TARGET_FEE_CODE": "",
        "TARGET_FEE_CURR": "",
        "TARGET_IDT_SCHEME": "",
        "TARGET_MEMBER_ID": "001483",
        "TARGET_NUMBER": "558740******2037",
        "TARGET_SERVICE": 0,
        "TARGET_SPC": "00",
        "TRANS_AMOUNT": 0,
        "TRANS_CITY": "Reykjavik",
        "TRANS_COND_ATTR": 37381,
        "TRANS_CONDITION": "NEV2",
        "TRANS_COUNTRY": "ISL",
        "TRANS_CURR": "352",
        "TRANS_DATE": "2022-05-17 11:39:30.000",
        "TRANS_DETAILS": "Borgun - profanir",
        "TRANS_STATE": "",
        "TRANS_TYPE": 0
    },
    "after": {
        "ACQ_REF_NUMBER": "",
        "ACTION": "",
        "ADD_INFO": "POSTAL_CODE=108;TRANS_LOCATION=Armuli 30;TOP_CONTRACT=866820;MERCH_COUNTRY=ISL;MPD=1025100006600352000;AP_PRTCL=2;SCA_RSN=10000;MERCH_CITY=Reykjavik    ;VPD=0000000007;MERCH_PC=IS108;MERCH_NAME=cardstream               ;BOR_ORIG_MID=9275444;TGTCC=ISL;PRODUCT_ID=MCO;APRPD_IND=N;CARD_AFS=C;CARD_PTI=2;ISO_CONTRACT=N;BORGUN_REGION=DOM;BASE_FEE=0;FEE_CURR=840;CARDTYPE=MCO;NNS_TR_CURR=352;C_ACQ_BIN;BINCHL=E;ACQ_NL;OPID=36824;ONLINE=Y;OC=E;RMSO=Y;SP_IPS_PRODUCT=MC;SP_USD_AMOUNT=0;SP_ISK_AMOUNT=0;ORIG_ID=12413672330;ORIGID_CNT=0;T_USG=X;S_USG=MXK;ACQ_USG;SLI=210;CVC2R=M;NRC=00;MDE16=20220517;FNW=E;",
        "AMND_DATE": "2022-05-17 11:39:30.000",
        "AMND_OFFICER": 14400,
        "AMND_PREV": 12413672330,
        "AMND_STATE": "A",
        "AUTH_CODE": "006814",
        "BIN_RECORD": 8439210,
        "CARD_EXPIRE": "2301",
        "CARD_SEQV_NUMBER": "",
        "CHANGE_VERSION": 0,
        "COMMENT_TEXT": "",
        "DOC__CHAIN__ID": 0,
        "DOC__ORIG__ID": 0,
        "DOC__PREV__ID": 0,
        "DOC__SUMM__ID": 0,
        "FX_SETTL_DATE": "2022-05-17 00:00:00.000",
        "ID": 12413672330,
        "IS_AUTHORIZATION": "P",
        "ISS_REF_NUMBER": "NET06013213544558740______2037",
        "MERCHANT_ID": "9275444",
        "MESSAGE_CATEGORY": "",
        "NUMBER_IN_CHAIN": 0,
        "NUMBER_OF_SUB_S": 0,
        "NW_REF_DATE": "2022-05-17 11:39:30.000",
        "OUTWARD_STATUS": "T",
        "PARTITION_KEY": "X",
        "POSTING_DATE": "",
        "POSTING_STATUS": "P",
        "PS_REF_NUMBER": "MCC011I3V0517",
        "REASON_CODE": "",
        "REASON_DETAILS": "",
        "REC_DATE": "2022-05-17 11:39:30.000",
        "REC_MEMBER_ID": "",
        "RECONS_AMOUNT": 0,
        "RECONS_CURR": "352",
        "REQUEST_CATEGORY": "Q",
        "REQUIREMENT": "",
        "RET_REF_NUMBER": "213780213544",
        "RETURN_CODE": 0,
        "SALT_TOKEN_ID": "c24ffe94-9948-4520-bb9d-b794ae0f1135",
        "S_CAT": "M",
        "SEC_TRANS_COND_ATT": 0,
        "SEC_TRANS_DATE": "",
        "SEND_MEMBER_ID": "005302",
        "SENDING_BIN": "545302",
        "SERVICE_CLASS": "X",
        "SETTL_AMOUNT": 0,
        "SETTL_CURR": "352",
        "SIC_CODE": "5734",
        "SOURCE_ACC_TYPE": "",
        "SOURCE_CHANNEL": "P",
        "SOURCE_CODE": "",
        "SOURCE_CONTRACT": 3091900,
        "SOURCE_FEE_AMOUNT": 0,
        "SOURCE_FEE_CODE": "",
        "SOURCE_FEE_CURR": "",
        "SOURCE_IDT_SCHEME": "",
        "SOURCE_MEMBER_ID": "1501",
        "SOURCE_NUMBER": "NET06013",
        "SOURCE_REG_NUM": "M137114LAITN",
        "SOURCE_SERVICE": 0,
        "SOURCE_SPC": "",
        "SYNCH_TAG": "",
        "T_CAT": "C",
        "TARGET_ACC_TYPE": "",
        "TARGET_BIN_ID": 0,
        "TARGET_CHANNEL": "E",
        "TARGET_CODE": "",
        "TARGET_CONTRACT": 659560,
        "TARGET_COUNTRY": "ISL",
        "TARGET_FEE_AMOUNT": 0,
        "TARGET_FEE_CODE": "",
        "TARGET_FEE_CURR": "",
        "TARGET_IDT_SCHEME": "",
        "TARGET_MEMBER_ID": "001483",
        "TARGET_NUMBER": "558740******2037",
        "TARGET_SERVICE": 0,
        "TARGET_SPC": "00",
        "TRANS_AMOUNT": 0,
        "TRANS_CITY": "Reykjavik",
        "TRANS_COND_ATTR": 37381,
        "TRANS_CONDITION": "NEV2",
        "TRANS_COUNTRY": "ISL",
        "TRANS_CURR": "352",
        "TRANS_DATE": "2022-05-17 11:39:30.000",
        "TRANS_DETAILS": "Borgun - profanir",
        "TRANS_STATE": "",
        "TRANS_TYPE": 0
    }
}

msg_way4 = producer.send(topic='transaction-card-validator-way4-ogg-raw-doc', value=msg_value_way4)


print(msg_way4.get(timeout=60))
